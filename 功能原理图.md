# åŠŸèƒ½å®ç°åŸç†å›¾

## ğŸ“Š æ•´ä½“æ¶æ„æµç¨‹

```mermaid
%%{init: {'theme':'dark', 'themeVariables': { 'primaryColor':'#6c7ae0','primaryTextColor':'#fff','primaryBorderColor':'#8b9de5','lineColor':'#8b9de5','secondaryColor':'#f0f8ff','tertiaryColor':'#fff5f9','textColor':'#e0e0e0','fontSize':'16px'}}}%%
flowchart TB
    Start([é¡µé¢åŠ è½½]) --> Init[è°ƒç”¨ init å‡½æ•°]
    Init --> Load[loadState åŠ è½½çŠ¶æ€]
    Init --> RenderE[renderEnergy æ˜¾ç¤ºèƒ½é‡]
    Init --> RenderH[renderHistory æ˜¾ç¤ºå†å²]
    Init --> UpdateD[updateDaysDisplay æ›´æ–°å¤©æ•°]
    Init --> Bind[bind ç»‘å®šäº‹ä»¶]
    Init --> BindT[bindTapProgress ç»‘å®šç‚¹å‡»]
    
    UpdateD --> Calc[calculateDaysTogether è®¡ç®—å¤©æ•°]
    Calc --> GetStart[è·å–èµ·å§‹æ—¥æœŸ: 2023-01-24]
    Calc --> GetToday[è·å–ä»Šå¤©æ—¥æœŸ]
    Calc --> CalcDiff[è®¡ç®—æ—¥æœŸå·®å€¼]
    CalcDiff --> Display[æ›´æ–° #days-count å…ƒç´ ]
    
    Display --> Complete([é¡µé¢å°±ç»ª])
    
    style Start fill:#6c7ae0,stroke:#8b9de5,stroke-width:3px,color:#fff
    style Complete fill:#6c7ae0,stroke:#8b9de5,stroke-width:3px,color:#fff
    style UpdateD fill:#f0f8ff,stroke:#6c7ae0,stroke-width:2px,color:#333
    style Calc fill:#fff5f9,stroke:#6c7ae0,stroke-width:2px,color:#333
    style Display fill:#e8f4f8,stroke:#6c7ae0,stroke-width:2px,color:#333
```

## ğŸ’ å¤©æ•°è®¡ç®—è¯¦ç»†æµç¨‹

```mermaid
%%{init: {'theme':'dark', 'themeVariables': { 'primaryColor':'#6c7ae0','primaryTextColor':'#fff','primaryBorderColor':'#8b9de5','lineColor':'#8b9de5','secondaryColor':'#f0f8ff','tertiaryColor':'#fff5f9','textColor':'#e0e0e0','fontSize':'16px'}}}%%
flowchart LR
    A[å¼€å§‹è®¡ç®—] --> B[åˆ›å»ºèµ·å§‹æ—¥æœŸå¯¹è±¡<br/>2023-01-24]
    B --> C[åˆ›å»ºä»Šå¤©æ—¥æœŸå¯¹è±¡]
    C --> D[å½’é›¶æ—¶é—´éƒ¨åˆ†<br/>setHours 0,0,0,0]
    D --> E[è®¡ç®—æ—¶é—´å·®<br/>today - startDate]
    E --> F[è½¬æ¢ä¸ºå¤©æ•°<br/>é™¤ä»¥86400000ms]
    F --> G[å‘ä¸‹å–æ•´<br/>Math.floor]
    G --> H[æ›´æ–°DOMæ˜¾ç¤º]
    H --> I[è¾“å‡ºæ—¥å¿—]
    I --> J[å®Œæˆ]
    
    style A fill:#6c7ae0,stroke:#8b9de5,stroke-width:2px,color:#fff
    style D fill:#fff5f9,stroke:#6c7ae0,stroke-width:2px,color:#333
    style G fill:#f0f8ff,stroke:#6c7ae0,stroke-width:2px,color:#333
    style H fill:#e8f4f8,stroke:#6c7ae0,stroke-width:2px,color:#333
    style J fill:#6c7ae0,stroke:#8b9de5,stroke-width:2px,color:#fff
```

## ğŸ¨ å‰ç«¯æ¸²æŸ“æµç¨‹

```mermaid
%%{init: {'theme':'dark', 'themeVariables': { 'primaryColor':'#6c7ae0','primaryTextColor':'#fff','primaryBorderColor':'#8b9de5','lineColor':'#8b9de5','secondaryColor':'#f0f8ff','tertiaryColor':'#fff5f9','textColor':'#e0e0e0','fontSize':'16px'}}}%%
sequenceDiagram
    participant User as ğŸ‘¤ ç”¨æˆ·
    participant Browser as ğŸŒ æµè§ˆå™¨
    participant HTML as ğŸ“„ HTML
    participant CSS as ğŸ¨ CSS
    participant JS as âš™ï¸ JavaScript
    
    User->>Browser: æ‰“å¼€ index.html
    Browser->>HTML: åŠ è½½DOMç»“æ„
    HTML->>Browser: è¿”å›å…ƒç´ æ ‘
    Browser->>CSS: åŠ è½½æ ·å¼æ–‡ä»¶
    CSS->>Browser: åº”ç”¨æ ·å¼è§„åˆ™
    Browser->>JS: æ‰§è¡Œ script.js
    
    JS->>JS: è§¦å‘ DOMContentLoaded
    JS->>JS: è°ƒç”¨ init()
    JS->>JS: è°ƒç”¨ updateDaysDisplay()
    JS->>JS: è°ƒç”¨ calculateDaysTogether()
    
    Note over JS: è®¡ç®—å¤©æ•°å·®å€¼
    
    JS->>HTML: æŸ¥æ‰¾ #days-count å…ƒç´ 
    HTML-->>JS: è¿”å›å…ƒç´ å¼•ç”¨
    JS->>HTML: è®¾ç½® textContent
    JS->>Browser: console.log æ—¥å¿—
    
    Browser->>CSS: è§¦å‘ .love-icon åŠ¨ç”»
    CSS-->>User: æ˜¾ç¤ºå¿ƒè·³æ•ˆæœ
    Browser-->>User: æ¸²æŸ“å®Œæ•´é¡µé¢
    
    Note over User,Browser: é¡µé¢åŠ è½½å®Œæˆ<br/>å¤©æ•°æ˜¾ç¤ºæ­£å¸¸
```

## ğŸ“± ç”¨æˆ·äº¤äº’æµç¨‹

```mermaid
%%{init: {'theme':'dark', 'themeVariables': { 'primaryColor':'#6c7ae0','primaryTextColor':'#fff','primaryBorderColor':'#8b9de5','lineColor':'#8b9de5','secondaryColor':'#f0f8ff','tertiaryColor':'#fff5f9','textColor':'#e0e0e0','fontSize':'16px'}}}%%
stateDiagram-v2
    [*] --> é¡µé¢åŠ è½½
    é¡µé¢åŠ è½½ --> æ˜¾ç¤ºå¤©æ•°: è‡ªåŠ¨è®¡ç®—
    æ˜¾ç¤ºå¤©æ•° --> ç­‰å¾…äº¤äº’: æ¸²æŸ“å®Œæˆ
    
    ç­‰å¾…äº¤äº’ --> ç‚¹å‡»å¸®åŠ©: ç”¨æˆ·ç‚¹å‡»ï¼ŸæŒ‰é’®
    ç‚¹å‡»å¸®åŠ© --> æ˜¾ç¤ºè¯´æ˜: æ‰“å¼€å¯¹è¯æ¡†
    æ˜¾ç¤ºè¯´æ˜ --> æŸ¥çœ‹1000å¤©: é˜…è¯»æ­å–œä¿¡æ¯
    æŸ¥çœ‹1000å¤© --> æŸ¥çœ‹ä½¿ç”¨æ–¹æ³•: æ»šåŠ¨æŸ¥çœ‹
    æŸ¥çœ‹ä½¿ç”¨æ–¹æ³• --> å…³é—­å¯¹è¯æ¡†: ç‚¹å‡»"å¼€å§‹æ¢ç´¢"
    å…³é—­å¯¹è¯æ¡† --> ç­‰å¾…äº¤äº’: è¿”å›ä¸»ç•Œé¢
    
    ç­‰å¾…äº¤äº’ --> è¡¥ç»™ç«™: æ·»åŠ èƒ½é‡
    è¡¥ç»™ç«™ --> ç­‰å¾…äº¤äº’: èƒ½é‡æ›´æ–°
    
    ç­‰å¾…äº¤äº’ --> æŠ½å¥–: ç‚¹å‡»ç›²ç›’
    æŠ½å¥– --> ç­‰å¾…äº¤äº’: è·å¾—å¥–åŠ±
    
    ç­‰å¾…äº¤äº’ --> [*]: å…³é—­é¡µé¢
    
    note right of æ˜¾ç¤ºå¤©æ•°
        å¤©æ•°å®æ—¶è®¡ç®—
        æ— éœ€æ‰‹åŠ¨åˆ·æ–°
    end note
    
    note right of æ˜¾ç¤ºè¯´æ˜
        æ–°ç‰ˆè¯´æ˜ä¹¦
        æ— è¿ç‚¹æœºåˆ¶
        å¼ºè°ƒ1000å¤©
    end note
```

## ğŸ”§ æ¨¡å—ä¾èµ–å…³ç³»

```mermaid
%%{init: {'theme':'dark', 'themeVariables': { 'primaryColor':'#6c7ae0','primaryTextColor':'#fff','primaryBorderColor':'#8b9de5','lineColor':'#8b9de5','secondaryColor':'#f0f8ff','tertiaryColor':'#fff5f9','textColor':'#e0e0e0','fontSize':'16px'}}}%%
graph TD
    A[index.html] --> B[script.js]
    A --> C[style.css]
    
    B --> D[init å‡½æ•°]
    D --> E[updateDaysDisplay]
    D --> F[loadState]
    D --> G[renderEnergy]
    D --> H[renderHistory]
    D --> I[bind]
    D --> J[bindTapProgress]
    
    E --> K[calculateDaysTogether]
    K --> L[Dateå¯¹è±¡æ“ä½œ]
    L --> M[DOMæ›´æ–°]
    
    C --> N[.love-days æ ·å¼]
    C --> O[.love-icon åŠ¨ç”»]
    C --> P[.help å¯¹è¯æ¡†æ ·å¼]
    
    N --> M
    O --> M
    
    I --> Q[å¸®åŠ©æŒ‰é’®äº‹ä»¶]
    Q --> R[æ˜¾ç¤ºå¯¹è¯æ¡†]
    R --> P
    
    style A fill:#6c7ae0,stroke:#8b9de5,stroke-width:3px,color:#fff
    style K fill:#fff5f9,stroke:#6c7ae0,stroke-width:2px,color:#333
    style M fill:#e8f4f8,stroke:#6c7ae0,stroke-width:2px,color:#333
    style P fill:#f0f8ff,stroke:#6c7ae0,stroke-width:2px,color:#333
```

## ğŸ¯ æ•°æ®æµå‘å›¾

```mermaid
%%{init: {'theme':'dark', 'themeVariables': { 'primaryColor':'#6c7ae0','primaryTextColor':'#fff','primaryBorderColor':'#8b9de5','lineColor':'#8b9de5','secondaryColor':'#f0f8ff','tertiaryColor':'#fff5f9','textColor':'#e0e0e0','fontSize':'16px'}}}%%
flowchart TD
    subgraph Input[è¾“å…¥å±‚]
        I1[èµ·å§‹æ—¥æœŸ<br/>2023-01-24]
        I2[ç³»ç»Ÿå½“å‰æ—¶é—´]
    end
    
    subgraph Process[å¤„ç†å±‚]
        P1[æ—¥æœŸå¯¹è±¡åˆ›å»º]
        P2[æ—¶é—´å½’é›¶å¤„ç†]
        P3[æ¯«ç§’å·®å€¼è®¡ç®—]
        P4[å¤©æ•°è½¬æ¢]
        P5[å‘ä¸‹å–æ•´]
    end
    
    subgraph Output[è¾“å‡ºå±‚]
        O1[æ›´æ–°DOMæ–‡æœ¬]
        O2[æ§åˆ¶å°æ—¥å¿—]
        O3[è§¦å‘CSSåŠ¨ç”»]
    end
    
    I1 --> P1
    I2 --> P1
    P1 --> P2
    P2 --> P3
    P3 --> P4
    P4 --> P5
    P5 --> O1
    P5 --> O2
    O1 --> O3
    
    style Input fill:#fff5f9,stroke:#6c7ae0,stroke-width:2px,color:#333
    style Process fill:#f0f8ff,stroke:#6c7ae0,stroke-width:2px,color:#333
    style Output fill:#e8f4f8,stroke:#6c7ae0,stroke-width:2px,color:#333
```

## ğŸ¬ åŠ¨ç”»æ—¶é—´è½´

```mermaid
%%{init: {'theme':'dark', 'themeVariables': { 'primaryColor':'#6c7ae0','primaryTextColor':'#fff','primaryBorderColor':'#8b9de5','lineColor':'#8b9de5','secondaryColor':'#f0f8ff','tertiaryColor':'#fff5f9','textColor':'#e0e0e0','fontSize':'16px'}}}%%
gantt
    title å¿ƒè·³åŠ¨ç”»æ—¶é—´è½´ (1.5ç§’å¾ªç¯)
    dateFormat SSS
    axisFormat %L ms
    
    section åŠ¨ç”»å¸§
    scale(1.0)        :000, 150ms
    scale(1.1)        :150, 50ms
    scale(1.0)        :200, 100ms
    scale(1.15)       :300, 50ms
    scale(1.0)        :350, 1150ms
    
    section è§†è§‰æ•ˆæœ
    æ­£å¸¸å¤§å°          :000, 150ms
    ç¬¬ä¸€æ¬¡æ”¾å¤§        :150, 50ms
    æ¢å¤              :200, 100ms
    ç¬¬äºŒæ¬¡æ”¾å¤§(æ›´å¤§)  :300, 50ms
    ä¿æŒç¨³å®š          :350, 1150ms
```

## ğŸ“ CSSæ ·å¼å±‚æ¬¡ç»“æ„

```mermaid
%%{init: {'theme':'dark', 'themeVariables': { 'primaryColor':'#6c7ae0','primaryTextColor':'#fff','primaryBorderColor':'#8b9de5','lineColor':'#8b9de5','secondaryColor':'#f0f8ff','tertiaryColor':'#fff5f9','textColor':'#e0e0e0','fontSize':'16px'}}}%%
graph TB
    A[.love-days å®¹å™¨] --> B[.love-icon emoji]
    A --> C[.love-text æ–‡æœ¬]
    C --> D[strong å¤©æ•°]
    
    A --> E1[flexå¸ƒå±€]
    A --> E2[æ¸å˜èƒŒæ™¯]
    A --> E3[åœ†è§’è¾¹æ¡†]
    
    B --> F[heartbeatåŠ¨ç”»]
    F --> F1[0%: scale 1]
    F --> F2[10%: scale 1.1]
    F --> F3[20%: scale 1]
    F --> F4[30%: scale 1.15]
    F --> F5[40%: scale 1]
    
    D --> G[ç´«è‰²é«˜äº®]
    D --> H[åŠ ç²—å­—ä½“]
    
    style A fill:#6c7ae0,stroke:#8b9de5,stroke-width:2px,color:#fff
    style B fill:#fff5f9,stroke:#6c7ae0,stroke-width:2px,color:#333
    style C fill:#f0f8ff,stroke:#6c7ae0,stroke-width:2px,color:#333
    style D fill:#e8f4f8,stroke:#6c7ae0,stroke-width:2px,color:#333
```

---

## ğŸ’¡ æ ¸å¿ƒåŸç†æ€»ç»“

### 1. æ—¥æœŸè®¡ç®—åŸç†
```javascript
// æ—¶é—´å·®è®¡ç®—å…¬å¼
å¤©æ•° = Math.floor((ä»Šå¤© - èµ·å§‹æ—¥æœŸ) / (1000 * 60 * 60 * 24))
```

### 2. DOMæ›´æ–°æœºåˆ¶
- å•æ¬¡è®¡ç®—ï¼šé¡µé¢åŠ è½½æ—¶æ‰§è¡Œä¸€æ¬¡
- å®‰å…¨æ£€æŸ¥ï¼šæ›´æ–°å‰éªŒè¯å…ƒç´ å­˜åœ¨
- æ€§èƒ½ä¼˜åŒ–ï¼šæ— éœ€å®šæ—¶åˆ·æ–°

### 3. åŠ¨ç”»å®ç°æ–¹å¼
- CSS @keyframesï¼šç¡¬ä»¶åŠ é€Ÿ
- animationå±æ€§ï¼šæ— é™å¾ªç¯
- transformï¼šæ€§èƒ½æœ€ä¼˜

### 4. æ ·å¼è®¾è®¡æ€è·¯
- ç²‰è“æ¸å˜ï¼šæµªæ¼«æ¸©é¦¨
- ç´«è‰²ä¸»è‰²ï¼šå“ç‰Œä¸€è‡´
- å¿ƒè·³åŠ¨ç”»ï¼šæƒ…æ„Ÿå…±é¸£

---

**æ–‡æ¡£ç‰ˆæœ¬**: 1.0  
**æœ€åæ›´æ–°**: 2025å¹´10æœˆ17æ—¥


